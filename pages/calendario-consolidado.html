<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calend√°rio Consolidado - MiraBoard</title>
    <link rel="icon" type="image/png" href="../assets/img/ico-miraboard.png">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Bootstrap CSS 5.3.2 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    
    <!-- FullCalendar CSS -->
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.css" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../assets/css/variables.css">
    <link rel="stylesheet" href="../assets/css/components.css">
    <link rel="stylesheet" href="../assets/css/layout.css">
    <link rel="stylesheet" href="../assets/css/dashboard.css">
    <link rel="stylesheet" href="../assets/css/calendario.css">
    <link rel="stylesheet" href="../assets/css/ux-enhancements.css">
</head>
<body>
    <div class="app-layout">
        <!-- Sidebar (injected via sidebar.js) -->
        <aside class="sidebar" id="sidebar"></aside>
        
        <!-- Main Content Area -->
        <div class="main-wrapper">
            <!-- Header -->
            <header class="app-header">
                <div class="header-left">
                    <button class="sidebar-toggle" id="sidebarToggle">
                        <i class="bi bi-list"></i>
                    </button>
                    <div class="header-search d-none d-md-block">
                        <div class="search-input-group">
                            <i class="bi bi-search"></i>
                            <input type="text" class="form-control" placeholder="Buscar eventos...">
                            <kbd>‚åòK</kbd>
                        </div>
                    </div>
                </div>
                
                <div class="header-right">
                    <!-- Sino de Notifica√ß√µes -->
                    <div class="dropdown">
                        <button class="header-action-btn position-relative" data-bs-toggle="dropdown">
                            <i class="bi bi-bell"></i>
                            <span class="notification-badge">5</span>
                        </button>
                        <div class="dropdown-menu dropdown-menu-end notification-dropdown" style="width: 350px;">
                            <div class="dropdown-header d-flex justify-content-between align-items-center">
                                <h6 class="mb-0 fw-semibold">Notifica√ß√µes</h6>
                                <a href="#" class="text-decoration-none small">Marcar como lidas</a>
                            </div>
                            <div class="dropdown-divider m-0"></div>
                            <a class="dropdown-item notification-item unread py-3" href="#">
                                <div class="notification-icon bg-danger-subtle">
                                    <i class="bi bi-exclamation-triangle-fill text-danger"></i>
                                </div>
                                <div class="notification-content">
                                    <p class="mb-1"><strong>ARPB vence em 3 dias!</strong></p>
                                    <span class="notification-time text-danger">Prazo: 29/12/2025</span>
                                </div>
                            </a>
                            <div class="dropdown-divider m-0"></div>
                            <a class="dropdown-item text-center py-2" href="#">Ver todas</a>
                        </div>
                    </div>
                    
                    <div class="dropdown">
                        <button class="header-user-btn" data-bs-toggle="dropdown">
                            <div class="avatar avatar-sm">
                                <img src="https://ui-avatars.com/api/?name=Admin+User&background=E8681A&color=fff" alt="Admin">
                            </div>
                            <span class="d-none d-md-inline">Admin</span>
                            <i class="bi bi-chevron-down"></i>
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="configuracoes.html"><i class="bi bi-person me-2"></i>Meu Perfil</a></li>
                            <li><a class="dropdown-item" href="configuracoes.html"><i class="bi bi-gear me-2"></i>Configura√ß√µes</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item text-danger" href="../index.html"><i class="bi bi-box-arrow-right me-2"></i>Sair</a></li>
                        </ul>
                    </div>
                </div>
            </header>
            
            <!-- Main Content -->
            <main class="main-content">
                <div class="content-wrapper">
                    <!-- Page Header -->
                    <div class="page-header">
                        <div>
                            <h1 class="page-title">
                                <i class="bi bi-calendar3 me-2 text-primary"></i>Calend√°rio Consolidado
                            </h1>
                            <p class="page-subtitle">Reuni√µes, prazos de a√ß√µes e obriga√ß√µes PREVIC em uma √∫nica visualiza√ß√£o</p>
                        </div>
                        <div class="page-actions">
                            <button class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#filtrosModal">
                                <i class="bi bi-funnel me-2"></i>Filtros
                            </button>
                            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#novoEventoModal">
                                <i class="bi bi-plus-lg me-2"></i>Novo Evento
                            </button>
                        </div>
                    </div>
                    
                    <div class="row g-4">
                        <!-- Sidebar - Legenda e Mini Calend√°rio -->
                        <div class="col-lg-3">
                            <!-- Legenda de Eventos -->
                            <div class="card mb-4">
                                <div class="card-header">
                                    <h5 class="card-title mb-0">
                                        <i class="bi bi-palette me-2"></i>Legenda
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="legenda-eventos">
                                        <label class="legenda-check">
                                            <input type="checkbox" checked data-type="reuniao">
                                            <span class="legenda-color" style="background: #E8681A;"></span>
                                            <span>Reuni√µes</span>
                                        </label>
                                        <label class="legenda-check">
                                            <input type="checkbox" checked data-type="acao">
                                            <span class="legenda-color" style="background: #3b82f6;"></span>
                                            <span>Prazos de A√ß√µes</span>
                                        </label>
                                        <label class="legenda-check">
                                            <input type="checkbox" checked data-type="obrigacao">
                                            <span class="legenda-color" style="background: #dc3545;"></span>
                                            <span>Obriga√ß√µes PREVIC</span>
                                        </label>
                                        <label class="legenda-check">
                                            <input type="checkbox" checked data-type="certificacao">
                                            <span class="legenda-color" style="background: #f59e0b;"></span>
                                            <span>Vencimento Certifica√ß√µes</span>
                                        </label>
                                        <label class="legenda-check">
                                            <input type="checkbox" checked data-type="documento">
                                            <span class="legenda-color" style="background: #8b5cf6;"></span>
                                            <span>Revis√£o Documentos</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Pr√≥ximos Eventos -->
                            <div class="card mb-4">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h5 class="card-title mb-0">
                                        <i class="bi bi-clock me-2"></i>Pr√≥ximos
                                    </h5>
                                    <span class="badge bg-primary">7 dias</span>
                                </div>
                                <div class="card-body p-0">
                                    <div class="proximos-eventos">
                                        <div class="proximo-evento urgente">
                                            <div class="evento-date">
                                                <span class="dia">29</span>
                                                <span class="mes">DEZ</span>
                                            </div>
                                            <div class="evento-info">
                                                <span class="evento-tipo obrigacao">PREVIC</span>
                                                <h6>ARPB - Envio</h6>
                                                <small>Prazo Final</small>
                                            </div>
                                        </div>
                                        
                                        <div class="proximo-evento">
                                            <div class="evento-date">
                                                <span class="dia">30</span>
                                                <span class="mes">DEZ</span>
                                            </div>
                                            <div class="evento-info">
                                                <span class="evento-tipo acao">A√ß√£o</span>
                                                <h6>Revisar Pol√≠tica de Investimentos</h6>
                                                <small>Carlos Lima</small>
                                            </div>
                                        </div>
                                        
                                        <div class="proximo-evento">
                                            <div class="evento-date">
                                                <span class="dia">02</span>
                                                <span class="mes">JAN</span>
                                            </div>
                                            <div class="evento-info">
                                                <span class="evento-tipo reuniao">Reuni√£o</span>
                                                <h6>Reuni√£o Ordin√°ria CD</h6>
                                                <small>14:00 - 16:00</small>
                                            </div>
                                        </div>
                                        
                                        <div class="proximo-evento">
                                            <div class="evento-date">
                                                <span class="dia">15</span>
                                                <span class="mes">JAN</span>
                                            </div>
                                            <div class="evento-info">
                                                <span class="evento-tipo obrigacao">PREVIC</span>
                                                <h6>AEQT 4¬∫ Tri</h6>
                                                <small>Prazo Final</small>
                                            </div>
                                        </div>
                                        
                                        <div class="proximo-evento">
                                            <div class="evento-date">
                                                <span class="dia">20</span>
                                                <span class="mes">JAN</span>
                                            </div>
                                            <div class="evento-info">
                                                <span class="evento-tipo certificacao">Certifica√ß√£o</span>
                                                <h6>ICSS - Jo√£o Silva</h6>
                                                <small>Vencimento</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Resumo do M√™s -->
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="card-title mb-0">
                                        <i class="bi bi-bar-chart me-2"></i>Este M√™s
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="resumo-item">
                                        <span class="resumo-label">Reuni√µes</span>
                                        <span class="resumo-value">3</span>
                                    </div>
                                    <div class="resumo-item">
                                        <span class="resumo-label">A√ß√µes com prazo</span>
                                        <span class="resumo-value">5</span>
                                    </div>
                                    <div class="resumo-item text-danger">
                                        <span class="resumo-label">Obriga√ß√µes PREVIC</span>
                                        <span class="resumo-value">2</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Calend√°rio Principal -->
                        <div class="col-lg-9">
                            <div class="card calendario-card">
                                <div class="card-body">
                                    <div id="calendario"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <!-- Modal: Novo Evento -->
    <div class="modal fade" id="novoEventoModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="bi bi-plus-circle me-2"></i>Novo Evento
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="mb-3">
                            <label class="form-label">Tipo de Evento</label>
                            <select class="form-select">
                                <option>Reuni√£o</option>
                                <option>Prazo de A√ß√£o</option>
                                <option>Obriga√ß√£o PREVIC</option>
                                <option>Lembrete</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">T√≠tulo</label>
                            <input type="text" class="form-control" placeholder="Nome do evento">
                        </div>
                        <div class="row g-3 mb-3">
                            <div class="col-md-6">
                                <label class="form-label">Data</label>
                                <input type="date" class="form-control">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Hora</label>
                                <input type="time" class="form-control">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Descri√ß√£o</label>
                            <textarea class="form-control" rows="2"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary">
                        <i class="bi bi-check-lg me-1"></i>Criar Evento
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal: Detalhes do Evento -->
    <div class="modal fade" id="eventoDetalheModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="eventoDetalheTitle">Detalhes do Evento</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="eventoDetalheBody">
                    <!-- Conte√∫do din√¢mico -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Fechar</button>
                    <a href="#" class="btn btn-primary" id="eventoDetalheLink">
                        <i class="bi bi-arrow-right me-1"></i>Ir para
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    
    <!-- FullCalendar JS -->
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js"></script>
    
    <!-- Sidebar Component -->
    <script src="../assets/js/sidebar.js"></script>
    
    <script>
        // Inicializar FullCalendar
        document.addEventListener('DOMContentLoaded', function() {
            const calendarEl = document.getElementById('calendario');
            
            const calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: 'dayGridMonth',
                locale: 'pt-br',
                headerToolbar: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'dayGridMonth,timeGridWeek,listWeek'
                },
                buttonText: {
                    today: 'Hoje',
                    month: 'M√™s',
                    week: 'Semana',
                    list: 'Lista'
                },
                height: 'auto',
                eventClick: function(info) {
                    showEventDetails(info.event);
                },
                events: [
                    // Reuni√µes (Laranja)
                    {
                        title: 'Reuni√£o Ordin√°ria CD',
                        start: '2025-01-02T14:00:00',
                        end: '2025-01-02T16:00:00',
                        backgroundColor: '#E8681A',
                        borderColor: '#E8681A',
                        extendedProps: {
                            type: 'reuniao',
                            description: 'Reuni√£o ordin√°ria mensal do Conselho Deliberativo',
                            link: 'reuniao-detalhe.html'
                        }
                    },
                    {
                        title: 'Comit√™ de Investimentos',
                        start: '2025-01-10T10:00:00',
                        end: '2025-01-10T12:00:00',
                        backgroundColor: '#E8681A',
                        borderColor: '#E8681A',
                        extendedProps: {
                            type: 'reuniao',
                            description: 'An√°lise de carteira e novos investimentos',
                            link: 'reuniao-detalhe.html'
                        }
                    },
                    {
                        title: 'Reuni√£o Conselho Fiscal',
                        start: '2025-01-20T09:00:00',
                        end: '2025-01-20T11:00:00',
                        backgroundColor: '#E8681A',
                        borderColor: '#E8681A',
                        extendedProps: {
                            type: 'reuniao',
                            description: 'Reuni√£o ordin√°ria do Conselho Fiscal',
                            link: 'reuniao-detalhe.html'
                        }
                    },
                    
                    // Obriga√ß√µes PREVIC (Vermelho)
                    {
                        title: '‚ö†Ô∏è ARPB - Prazo Final',
                        start: '2025-12-29',
                        backgroundColor: '#dc3545',
                        borderColor: '#dc3545',
                        extendedProps: {
                            type: 'obrigacao',
                            description: 'An√°lise do Relat√≥rio de Perfil de Benefici√°rios - Envio obrigat√≥rio',
                            link: 'obrigacoes.html'
                        }
                    },
                    {
                        title: '‚ö†Ô∏è DAIR Dezembro',
                        start: '2025-01-15',
                        backgroundColor: '#dc3545',
                        borderColor: '#dc3545',
                        extendedProps: {
                            type: 'obrigacao',
                            description: 'Demonstrativo de Aplica√ß√£o e Investimento dos Recursos',
                            link: 'obrigacoes.html'
                        }
                    },
                    {
                        title: '‚ö†Ô∏è AEQT 4¬∫ Tri',
                        start: '2025-01-15',
                        backgroundColor: '#dc3545',
                        borderColor: '#dc3545',
                        extendedProps: {
                            type: 'obrigacao',
                            description: 'Avalia√ß√£o Econ√¥mico-Atuarial e do Equil√≠brio T√©cnico',
                            link: 'obrigacoes.html'
                        }
                    },
                    
                    // Prazos de A√ß√µes (Azul)
                    {
                        title: 'üìã Revisar Pol√≠tica Investimentos',
                        start: '2025-12-30',
                        backgroundColor: '#3b82f6',
                        borderColor: '#3b82f6',
                        extendedProps: {
                            type: 'acao',
                            description: 'Respons√°vel: Carlos Lima',
                            link: 'acoes.html'
                        }
                    },
                    {
                        title: 'üìã Preparar relat√≥rio PREVIC',
                        start: '2025-01-05',
                        backgroundColor: '#3b82f6',
                        borderColor: '#3b82f6',
                        extendedProps: {
                            type: 'acao',
                            description: 'Respons√°vel: Ana Santos',
                            link: 'acoes.html'
                        }
                    },
                    {
                        title: 'üìã Atualizar cadastro membros',
                        start: '2025-01-08',
                        backgroundColor: '#3b82f6',
                        borderColor: '#3b82f6',
                        extendedProps: {
                            type: 'acao',
                            description: 'Respons√°vel: Maria Oliveira',
                            link: 'acoes.html'
                        }
                    },
                    
                    // Vencimento Certifica√ß√µes (Amarelo)
                    {
                        title: 'üéì ICSS - Jo√£o Silva',
                        start: '2025-01-20',
                        backgroundColor: '#f59e0b',
                        borderColor: '#f59e0b',
                        extendedProps: {
                            type: 'certificacao',
                            description: 'Certifica√ß√£o ICSS vence em 20/01/2026',
                            link: 'membros.html'
                        }
                    },
                    
                    // Revis√£o de Documentos (Roxo)
                    {
                        title: 'üìÑ Revis√£o Pol√≠tica de Investimentos',
                        start: '2025-01-25',
                        backgroundColor: '#8b5cf6',
                        borderColor: '#8b5cf6',
                        extendedProps: {
                            type: 'documento',
                            description: 'Documento desatualizado h√° 14 meses - Revis√£o obrigat√≥ria',
                            link: 'biblioteca.html'
                        }
                    }
                ]
            });
            
            calendar.render();
            
            // Filtrar eventos por tipo
            document.querySelectorAll('.legenda-check input').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const type = this.dataset.type;
                    const events = calendar.getEvents();
                    
                    events.forEach(event => {
                        if (event.extendedProps.type === type) {
                            event.setProp('display', this.checked ? 'auto' : 'none');
                        }
                    });
                });
            });
        });
        
        // Mostrar detalhes do evento
        function showEventDetails(event) {
            const modal = new bootstrap.Modal(document.getElementById('eventoDetalheModal'));
            
            document.getElementById('eventoDetalheTitle').textContent = event.title.replace(/[‚ö†Ô∏èüìãüéìüìÑ]/g, '').trim();
            
            let typeLabel = '';
            switch(event.extendedProps.type) {
                case 'reuniao': typeLabel = '<span class="badge bg-warning text-dark">Reuni√£o</span>'; break;
                case 'obrigacao': typeLabel = '<span class="badge bg-danger">Obriga√ß√£o PREVIC</span>'; break;
                case 'acao': typeLabel = '<span class="badge bg-primary">A√ß√£o</span>'; break;
                case 'certificacao': typeLabel = '<span class="badge bg-warning">Certifica√ß√£o</span>'; break;
                case 'documento': typeLabel = '<span class="badge bg-secondary">Documento</span>'; break;
            }
            
            const dateStr = event.start.toLocaleDateString('pt-BR', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
            
            let timeStr = '';
            if (event.end) {
                const startTime = event.start.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
                const endTime = event.end.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
                timeStr = `<p><i class="bi bi-clock me-2"></i>${startTime} - ${endTime}</p>`;
            }
            
            document.getElementById('eventoDetalheBody').innerHTML = `
                <div class="mb-3">${typeLabel}</div>
                <p><i class="bi bi-calendar me-2"></i>${dateStr}</p>
                ${timeStr}
                <p class="text-muted">${event.extendedProps.description || ''}</p>
            `;
            
            document.getElementById('eventoDetalheLink').href = event.extendedProps.link || '#';
            
            modal.show();
        }
    </script>
    <!-- Fake Actions -->
    <script src="../assets/js/fake-actions.js"></script>
    <script src="../assets/js/global-search.js"></script>
    <script src="../assets/js/empty-states.js"></script>
    <script src="../assets/js/shortcuts-tour.js"></script>
    <script src="../assets/js/breadcrumbs.js"></script>
</body>
</html>
